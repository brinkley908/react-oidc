(this["webpackJsonp@spekta/react-oidc-example"]=this["webpackJsonp@spekta/react-oidc-example"]||[]).push([[0],{20:function(e,t,n){e.exports=n(35)},21:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);n(21);var o=n(0),a=n.n(o),i=n(17),s=n.n(i),c=n(9),r=n(1),l=n(10),h=n(11),g=n(13),d=n.n(g),p=n(18),u=n(7);class m{constructor(e,t,n,o){var a=this;this.getUserManager=()=>this.UserManager,this.signinRedirectCallback=()=>{this.UserManager.signinRedirectCallback().then(()=>{})},this.getUser=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.UserManager.getUser();case 2:if(t=e.sent){e.next=7;break}return e.next=6,a.UserManager.signinRedirectCallback();case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)}))),this.signinRedirect=()=>{(this.localStore?localStorage:sessionStorage).setItem("redirectUri",window.location.pathname),this.UserManager.signinRedirect({})},this.navigateToScreen=()=>{var e=(this.localStore?localStorage:sessionStorage).getItem("redirectUri");window.location.replace(e)},this.getClientId=()=>void 0===this.identityConfig||void 0===this.identityConfig.client_id?"example":this.identityConfig.client_id,this.getStorage=()=>{const e=this.localStore?localStorage:sessionStorage;return JSON.parse(e.getItem("oidc.user:".concat(this.identityConfig.authority,":").concat(this.identityConfig.client_id)))},this.isAuthenticated=()=>{const e=this.localStore?localStorage:sessionStorage,t=JSON.parse(e.getItem("oidc.user:".concat(this.identityConfig.authority,":").concat(this.identityConfig.client_id)));return!!t&&!!t.access_token},this.getAccessToken=()=>{const e=this.localStore?localStorage:sessionStorage,t=JSON.parse(e.getItem("oidc.user:".concat(this.identityConfig.authority,":").concat(this.identityConfig.client_id)));return t&&t.access_token?t.access_token:""},this.parseJwt=e=>{const t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))},this.signinSilent=()=>{this.UserManager.signinSilent().then(e=>{console.log("signed in",e)}).catch(e=>{console.log(e)})},this.signinSilentCallback=()=>{this.UserManager.signinSilentCallback()},this.createSigninRequest=()=>this.UserManager.createSigninRequest(),this.logout=()=>{const e=this.localStore?localStorage:sessionStorage;this.UserManager.signoutRedirect({id_token_hint:e.getItem("id_token")}),this.UserManager.clearStaleState()},this.signoutRedirectCallback=()=>{const e=this.localStore?localStorage:sessionStorage;this.UserManager.signoutRedirectCallback().then(()=>{e.clear(),window.location.replace(this.identityConfig.publicUrl)}),this.UserManager.clearStaleState()},e=function(e){return e||{authority:"https://localhost:44395",client_id:"example",redirect_uri:"http://localhost:3000/signin-oidc",login:"https://localhost:44395/account/login",automaticSilentRenew:"true",loadUserInfo:"true",silent_redirect_uri:"http://localhost:3000/silentrenew",post_logout_redirect_uri:"http://localhost:3000/logout",audience:"https://example.com",response_type:"code",response_mode:"fragment",grantType:"pasword",scope:"openid profile email roles dataEventRecords offline_access",webAuthResponseType:"code",publicUrl:"http://localhost:3000"}}(e),t=function(e){return e||{issuer:"https://localhost:44395/",jwks_uri:"https://localhost:44395/.well-known/jwks",authorization_endpoint:"https://localhost:44395/connect/authorize",token_endpoint:"https://localhost:44395/connect/token",userinfo_endpoint:"https://localhost:44395/connect/userinfo",end_session_endpoint:"https://localhost:44395/connect/endsession",check_session_iframe:"https://localhost:44395/connect/checksession",revocation_endpoint:"https://localhost:44395/connect/revocation",introspection_endpoint:"https://localhost:44395/connect/itrospect"}}(t),this.localStore=n,this.identityConfig=e;const i=this.localStore?localStorage:sessionStorage;this.UserManager=new u.UserManager(Object(h.a)(Object(h.a)({},e),{},{userStore:new u.WebStorageStateStore({store:i}),metadata:Object(h.a)({},t)})),o&&(u.Log.logger=o,u.Log.level=u.Log.DEBUG),this.UserManager.events.addUserLoaded(e=>{console.log("addUserLoaded event"),-1!==window.location.href.indexOf("signin-oidc")&&this.navigateToScreen()}),this.UserManager.events.addSilentRenewError(e=>{console.log("silent renew error",e.message)}),this.UserManager.events.addAccessTokenExpired(()=>{console.log("token expired"),this.signinSilent()})}}const S=a.a.createContext({signinRedirectCallback:()=>({}),logout:()=>({}),signoutRedirectCallback:()=>({}),isAuthenticated:()=>({}),signinRedirect:()=>({}),signinSilentCallback:()=>({}),createSigninRequest:()=>({}),getAccessToken:()=>({}),getUserManager:()=>({})}),_=S.Consumer;class k extends o.Component{constructor(e){super(e),this.authService=new m(e.identityConfig,e.metaData,void 0===e.localStore||e.localStore,e.logger)}render(){return a.a.createElement(S.Provider,{value:this.authService},this.props.children)}}const f=e=>{let t=e.component,n=e.loadingComponent,o=Object(l.a)(e,["component","loadingComponent"]);const i=n||a.a.createElement("span",null,"loading...");return a.a.createElement(r.a,Object.assign({},o,{render:(s=t,e=>a.a.createElement(_,null,({isAuthenticated:t,signinRedirect:n,getAccessToken:o})=>{const c=o();return s&&t()?a.a.createElement(s,Object.assign({},e,{accessToken:c})):(n(),{loading:i})}))}));var s},b=()=>a.a.createElement(_,null,({signinRedirectCallback:e})=>(e(),a.a.createElement("span",null,"loading"))),w=()=>a.a.createElement(_,null,({logout:e})=>(e(),a.a.createElement("span",null,"loading"))),E=()=>a.a.createElement(_,null,({signoutRedirectCallback:e})=>(e(),a.a.createElement("span",null,"loading"))),C=()=>a.a.createElement("div",null,"register"),v=()=>a.a.createElement(_,null,({signinSilentCallback:e})=>(e(),a.a.createElement("span",null,"loading"))),U=()=>a.a.createElement("div",null,"Public page"),y=e=>{e.accessToken;return a.a.createElement("div",{id:"profile-partial-service"},a.a.createElement("div",null,"Private page"))},R={authority:"https://localhost:44395",client_id:"example",redirect_uri:"http://localhost:3000/signin-oidc",login:"https://localhost:44395/account/login",automaticSilentRenew:"true",loadUserInfo:"true",silent_redirect_uri:"http://localhost:3000/silentrenew",post_logout_redirect_uri:"http://localhost:3000/logout",response_type:"code",response_mode:"fragment",scope:"openid profile email roles dataEventRecords offline_access",webAuthResponseType:"code",publicUrl:"http://localhost:3000"},x={issuer:"https://localhost:44395/",jwks_uri:"https://localhost:44395/.well-known/jwks",authorization_endpoint:"https://localhost:44395/connect/authorize",token_endpoint:"https://localhost:44395/connect/token",userinfo_endpoint:"https://localhost:44395/connect/userinfo",end_session_endpoint:"https://localhost:44395/connect/endsession",check_session_iframe:"https://localhost:44395/connect/checksession",revocation_endpoint:"https://localhost:44395/connect/revocation",introspection_endpoint:"https://localhost:44395/connect/itrospect"};n(34);class M extends o.Component{render(){return a.a.createElement(k,{logger:console,identityConfig:R,metaData:x},a.a.createElement(c.a,{basename:"/"},a.a.createElement(r.c,null,a.a.createElement(r.a,{exact:!0,path:"/signin-oidc",component:b}),a.a.createElement(r.a,{exact:!0,path:"/logout",component:w}),a.a.createElement(r.a,{exact:!0,path:"/logout/callback",component:E}),a.a.createElement(r.a,{exact:!0,path:"/register",component:C}),a.a.createElement(r.a,{exact:!0,path:"/silentrenew",component:v}),a.a.createElement(f,{path:"/dashboard",component:y}),a.a.createElement(r.a,{path:"/",component:U}))))}}s.a.render(a.a.createElement(M,null),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.09b24575.chunk.js.map